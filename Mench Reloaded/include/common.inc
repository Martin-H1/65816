; -----------------------------------------------------------------------------
; Common aliases and macros useful in any file.
; Martin Heermance <mheermance@gmail.com>
; -----------------------------------------------------------------------------

;
; Put assembler in 16 bit mode, as 8 bit mode is the exception
; selected at module level.
;
.A16
.I16

;
; Aliases
;

; masking building symbols
LOWNIB	= $0F
HINIB	= $F0

Bit0	= $01
Bit1	= $02
Bit2	= $04
Bit3	= $08
Bit4	= $10
Bit5	= $20
Bit6	= $40
Bit7	= $80

; Processor Register Locations
BCR = $DF40		; BUS CONTROL REGISTER
			; BIT 0-EXTERNAL MEM BUS ENABLE
			; BIT 1-TONE GEN 0 ENABLE
			; BIT 2-TONE GEN 1 ENABLE
			; BIT 3-ICE ENABLE=1
			; BIT 4-MONITOR "WATCH DOG" ENABLE
			; BIT 5-ABORT ENABLE = 1 ON P40
			; BIT 6-NMI ENABLE = 1 ON P40
			; BIT 7-EXTERNAL $E000-$FFFF = 1

TCR = $DF42		; TIMER CONTROL REGISTER
			; BIT 0-TIMER 4 INPUT CLOCK 0 = FCLK
			; BIT 1-TIMER 4 OUTPUT ENABLE 1 = OUTPUT ON P61
			; BIT 2 & 3-PWM	 00 = DISABLE,	     01 = POSITIVE EDGE
			; BIT 3-	 10 = NEGATIVE EDGE, 11 = BOTH EDGES
			; BIT 4-UART0 TIMER SELECT 0 = TIMER 3, 1 = T4
			; BIT 5-UART1 TIMER SELECT 0 = TIMER 3, 1 = T4
			; BIT 6-UART2 TIMER SELECT 0 = TIMER 3, 1 = T4
			; BIT 7-UART3 TIMER SELECT 0 = TIMER 3, 1 = T4

; T0 = MONITOR "WATCH DOG"
; T1 = TIME OF DAY CLOCK
; T2 = PRESCALED INTERRUPT (UP COUNTER )
; T3 = UART #2
; T4 = UART #3
; T5 = TONE GENERATOR
; T6 = TONE GENERATOR
; T7 = PWM

TER = $DF43		; TIMER ENABLE REGISTER
			; BIT 0-TIMER 0  1 = ENABLE
			; BIT 1-TIMER 1  1 = ENABLE
			; BIT 2-TIMER 2  1 = ENABLE
			; BIT 3-TIMER 3  1 = ENABLE
			; BIT 4-TIMER 4  1 = ENABLE
			; BIT 5-TIMER 5  1 = ENABLE
			; BIT 6-TIMER 6  1 = ENABLE
			; BIT 7-TIMER 7  1 = ENABLE
T0FLG = $01
T1FLG = $02
T2FLG = $04
T3FLG = $08
T4FLG = $10
T5FLG = $20
T6FLG = $40
T7FLG = $80

TIFR = $DF44		; TIMER INTERRUPT FLAG REGISTER
			; BIT 0-TIMER 0	 1 = INTERRUPT PENDING
			; BIT 1-TIMER 1	 1 = INTERRUPT PENDING
			; BIT 2-TIMER 2	 1 = INTERRUPT PENDING
			; BIT 3-TIMER 3	 1 = INTERRUPT PENDING
			; BIT 4-TIMER 4	 1 = INTERRUPT PENDING
			; BIT 5-TIMER 5	 1 = INTERRUPT PENDING
			; BIT 6-TIMER 6	 1 = INTERRUPT PENDING
			; BIT 7-TIMER 7	 1 = INTERRUPT PENDING

EIFR = $DF45		; EDGE INTERRUPT FLAG REGISTER
			; BIT 0-PE56 EDGE IRQ
			; BIT 1-NE57 EDGE IRQ
			; BIT 2-PE60 EDGE IRQ
			; BIT 3-PWM  PROGRAMABLE EDGE IRQ (P62)
			; BIT 4-NE64 EDGE IRQ
			; BIT 5-NE66 EDGE IRQ
			; BIT 6-PIB	  IRQ
			; BIT 7-IRQ  LEVEL IRQ

TIER = $DF46		; TIMER INTERRUPT ENABLE REGISTER
			; BIT 0-TIMER 0	 1 = IRQ ENABLE
			; BIT 1-TIMER 1	 1 = IRQ ENABLE
			; BIT 2-TIMER 2	 1 = IRQ ENABLE
			; BIT 3-TIMER 3	 1 = IRQ ENABLE
			; BIT 4-TIMER 4	 1 = IRQ ENABLE
			; BIT 5-TIMER 5	 1 = IRQ ENABLE
			; BIT 6-TIMER 6	 1 = IRQ ENABLE
			; BIT 7-TIMER 7	 1 = IRQ ENABLE

T0LL = $DF50		; TIMER 0 LATCH LOW
T0LH = $DF51		; TIMER 0 LATCH HIGH
T1LL = $DF52		; TIMER 1 LATCH LOW
T1LH = $DF53		; TIMER 1 LATCH HIGH
T2LL = $DF54		; TIMER 2 LATCH LOW
T2LH = $DF55		; TIMER 2 LATCH HIGH
T3LL = $DF56		; TIMER 3 LATCH LOW
T3LH = $DF57		; TIMER 3 LATCH HIGH
T4LL = $DF58		; TIMER 4 LATCH LOW
T4LH = $DF59		; TIMER 4 LATCH HIGH
T5LL = $DF5A		; TIMER 5 LATCH LOW
T5LH = $DF5B		; TIMER 5 LATCH HIGH
T6LL = $DF5C		; TIMER 6 LATCH LOW
T6LH = $DF5D		; TIMER 6 LATCH HIGH
T7LL = $DF5E		; TIMER 7 LATCH LOW
T7LH = $DF5F		; TIMER 7 LATCH HIGH

T0CL = $DF60		; TIMER 0 COUNTER LOW
T0CH = $DF61		; TIMER 0 COUNTER HIGH
T1CL = $DF62		; TIMER 1 COUNTER LOW
T1CH = $DF63		; TIMER 1 COUNTER HIGH
T2CL = $DF64		; TIMER 2 COUNTER LOW
T2CH = $DF65		; TIMER 2 COUNTER HIGH
T3CL = $DF66		; TIMER 3 COUNTER LOW
T3CH = $DF67		; TIMER 3 COUNTER HIGH
T4CL = $DF68		; TIMER 4 COUNTER LOW
T4CH = $DF69		; TIMER 4 COUNTER HIGH
T5CL = $DF6A		; TIMER 5 COUNTER LOW
T5CH = $DF6B		; TIMER 5 COUNTER HIGH
T6CL = $DF6C		; TIMER 6 COUNTER LOW
T6CH = $DF6D		; TIMER 6 COUNTER HIGH
T7CL = $DF6E		; TIMER 7 COUNTER LOW
T7CH = $DF6F		; TIMER 7 COUNTER HIGH

; control bits for REP and SEP
MEM16	= $20
IND16	= $10

;
; Macros
;

; These are from the WDC 65c265 monitor ROM listing. Reusing them allows
; using code from the monitor with minimal changes.

.macro ON16MEM
       .A16		; tell the assembler about mode
       rep #MEM16	; set 8-bit accumulator mode
.endmacro

.macro OFF16MEM
       .A8
       sep #MEM16
.endmacro

.macro ON16X
       .I16
       rep #IND16
.endmacro

.macro OFF16X
       .I8
       sep #IND16
.endmacro

.macro ON16
       .A16
       .I16
       rep #(MEM16 | IND16)
.endmacro

.macro OFF16
       .A8
       .I8
       sep #(MEM16 | IND16)
.endmacro

.macro PUBLIC function_name
.export function_name
.proc function_name
.endmacro

.macro ENDPUBLIC
.endproc
.endmacro
